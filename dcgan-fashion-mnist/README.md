# Deep Convolutional Generative Adversarial Network (DCGAN)

This repository contains an implementation of a `DCGAN` trained on fashion-mnist. This is one of my [assignments](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/is.ipynb) for Seasons of Codes [SoC'24] at IIT Bombay.

## Model Overview
The DCGAN consists of models build using CNNs : a generator and a discriminator, trained simultaneously to generate high-quality images. The generator learns to create images that are indistinguishable from real images, while the discriminator learns to distinguish between real and generated images.

## Components

### Generator Model
- The generator uses convolutional layers to transform input noise into images.
- It employs techniques like batch normalization and activation functions I used was LeakyReLU (as ReLU might lead to gradient vanishing) to stabilize training and enhance image quality.

### Discriminator Model
- The discriminator is a CNN that classifies images into real (from dataset) or fake (generated by the generator).
- Leaky ReLU activation is used to prevent sparse gradients and improve learning.

### Training Process
- The model is trained iteratively:
  1. The generator creates images from random noise.
  2. The discriminator evaluates the images, optimizing to correctly classify real and fake images.
  3. Loss functions () guide the optimization process.
  4. Training continues until the generator produces descent realistic images

#### Optimizer I used is Adam.
  ```
  optimizer = tf.keras.optimizers.Adam(learning_rate = 0.0001, beta_1 = 0.5 )
  ```
#### I used following loss functions
**BinaryCrossentropy**
  ```
  cross_entropy = tf.keras.losses.BinaryCrossentropy(from_logits = False)
  ```
**MeanSquaredError**
  ```
  mse = tf.keras.losses.MeanSquaredError()
  ```
**HingeLoss**
  ```
  def discriminator_loss(real_output, fake_output):
    real_loss = tf.reduce_mean(tf.nn.relu(1.0 - real_output))
    fake_loss = tf.reduce_mean(tf.nn.relu(1.0 + fake_output))
    return real_loss + fake_loss
  
  def generator_loss(fake_output):
    return -tf.reduce_mean(fake_output)
  ```
### Evaluation

#### Inception Score
- It measures the quality and diversity of generated images using a pretrained InceptionV3 model.

## Repository Structure

- `images`: Contains image output of each trained generator over epochs
- `.ipynb`: Jupyter notebook for training the DCGAN with respective loss function
- `generator`: Saved generator model
- `history`: Pickled file containing training history of discriminator losses and generator losses.
  
## Results

| Model Name      | Loss Function | Loss vs Epochs | 
|-----------------|---------------|---------------|
| `dcgan-fashion-mnist-bce` | **BinaryCrossEntropy(from_logits = False)** | <img src="https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/loss-over-epochs/loss-vs-epochs/bce.png" alt="bce" width="400">| 
| `dcgan-fashion-mnist-mse` | **MeanSquaredError()** | <img src="https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/loss-over-epochs/loss-vs-epochs/mse.png" alt="hingeloss" width="400"> | 
| `dcgan-fashion-mnist-hingeloss` | **Hinge Loss** | <img src="https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/loss-over-epochs/loss-vs-epochs/hingeloss.png" alt="bce" width="400"> | 
| ``dcgan-fashion-mnist-bce-before-modification`` | **BinaryCrossEntropy(from_logits = False)** | <img src="https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/loss-over-epochs/loss-vs-epoch-before-modification/bce.png" alt="bce" width="400"> | 
| ``dcgan-fashion-mnist-mse-before-modification`` | **MeanSquaredError()** |<img src="https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/loss-over-epochs/loss-vs-epoch-before-modification/mse.png" alt="mse" width="400"> |
| ``dcgan-fashion-mnist-hingeloss-before-modification`` |  **Hinge Loss** |<img src="https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/loss-over-epochs/loss-vs-epoch-before-modification/hingeloss.png" alt="hingeloss" width="400"> | 

> **For following table, calculation for inception score is in [this](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/is.ipynb) file**

| Model Name      | Model Notebook | Model Generator | Model History | Model Evaluation (Inception Score) |
|-----------------|----------------|-----------------|---------------|------------------------------------|
| `dcgan-fashion-mnist-bce` | [.ipynb](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/dcgan-fashion-mnist-bce.ipynb) [.pdf](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/notebook-pdf-form/dcgan-fashion-mnist-bce.pdf)  | [.h5](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/generator/generator-fashion-mnist-bce.h5) | [.pkl](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/history/dcgan-fashion-mnist-history-loss-bce.pkl) | `1.0478562116622925 ± 0.0015827632742002606` |
| `dcgan-fashion-mnist-mse` | [.ipynb](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/dcgan-fashion-mnist-mse.ipynb) [.pdf](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/notebook-pdf-form/dcgan-fashion-mnist-mse.pdf)  | [.h5](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/generator/generator-fashion-mnist-mse.h5) | [.pkl](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/history/dcgan-fashion-mnist-history-loss-mse.pkl) | `1.0496829748153687 ± 0.0026156932581216097` |
| `dcgan-fashion-mnist-hingeloss` | [.ipynb](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/dcgan-fashion-mnist-hingeloss.ipynb) [.pdf](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/notebook-pdf-form/dcgan-fashion-mnist-hingeloss.pdf)  | [.h5](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/generator/generator-fashion-mnist-hingeloss.h5) | [.pkl](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/history/dcgan-fashion-mnist-history-loss-hingeloss.pkl) | `1.0491445064544678 ± 0.002100131241604686` |
| `dcgan-fashion-mnist-bce-before-modification` | [.ipynb](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/dcgan-fashion-mnist-bce-before-modification.ipynb) [.pdf](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/notebook-pdf-form/dcgan-fashion-mnist-bce-before-modificatione.pdf)  | [.h5](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/generator/generator-dcgan-fashion-mnist-bce-before-modification.h5) | [.pkl](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/history/dcgan-fashion-mnist-bce-history-before-modification.pkl) | ` 1.052344560623169 ± 0.0023420441430062056`|
| `dcgan-fashion-mnist-mse-before-modification` | [.ipynb](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/dcgan-fashion-mnist-mse-before-modification.ipynb) [.pdf](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/notebook-pdf-form/dcgan-fashion-mnist-mse-before-modificatione.pdf)  | [.h5](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/generator/generator-dcgan-fashion-mnist-mse-before-modification.h5) | [.pkl](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/history/dcgan-fashion-mnist-mse-history-before-modification.pkl) | `1.0537641048431396 ± 0.003162262961268425`|
| `dcgan-fashion-mnist-hingeloss-before-modification` | [.ipynb](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/dcgan-fashion-mnist-hingeloss-before-modification.ipynb) [.pdf](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/notebook-pdf-form/dcgan-fashion-mnist-hingeloss-before-modificatione.pdf)  | [.h5](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/generator/generator-dcgan-fashion-mnist-hingeloss-before-modification.h5) | [.pkl](https://github.com/shoryasethia/GAN/blob/main/dcgan-fashion-mnist/history/dcgan-fashion-mnist-hingeloss-history-before-modification.pkl) | `1.0504525899887085 ± 0.002676961710676551`|

> **Inception Score = mean ± std**
